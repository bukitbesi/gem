/**
 * Alchemist Theme - Main JavaScript File
 */
function initMobileNav(){const e=document.getElementById("nav-toggle"),t=document.getElementById("nav-menu");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("active")})}function initBreakingNews(){fetch("/feeds/posts/default?alt=json&max-results=10&orderby=published").then(e=>e.json()).then(e=>{const t=e.feed.entry||[],n=document.getElementById("breaking-ticker");if(t.length>0&&n){n.innerHTML="";t.forEach((e,t)=>{const s=e.title.$t,i=e.link.find(e=>"alternate"===e.rel).href,a=document.createElement("a");a.href=i;a.className="ticker-item";a.textContent=s;a.style.animationDelay=`${5*t}s`;n.appendChild(a)})}}).catch(e=>{console.error("Error fetching breaking news:",e)})}function initThemeToggle(){const e=document.getElementById("theme-toggle");e&&e.addEventListener("click",()=>{const t=document.documentElement.getAttribute("data-theme"),n="light"===t?"dark":"light";document.documentElement.setAttribute("data-theme",n);localStorage.setItem("theme",n);e.textContent="dark"===n?"☀️":"🌙"})}function initBackToTop(){const e=document.getElementById("back-to-top");e&&(window.addEventListener("scroll",()=>{window.scrollY>300?e.classList.add("show"):e.classList.remove("show")},{passive:!0}),e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function copyPostLink(e){e.preventDefault();const t=window.location.href;navigator.clipboard&&navigator.clipboard.writeText(t).then(()=>{const e=event.currentTarget,t=e.textContent;e.textContent="✓ Copied!";setTimeout(()=>{e.textContent=t},2e3)})}function fetchRelatedPosts(){const e=document.getElementById("related-posts-container"),t=document.querySelector(".post-single");if(!e||!t)return;const n=t.querySelector('.post-meta a[rel="tag"]');if(!n)return;const s=n.textContent.trim(),i=window.location.href;fetch(`/feeds/posts/default/-/${encodeURIComponent(s)}?alt=json&max-results=5`).then(e=>e.json()).then(t=>{const n=t.feed.entry||[],s=n.filter(e=>e.link.find(e=>"alternate"===e.rel).href!==i).slice(0,4);if(s.length>0){let t="";s.forEach(e=>{const n=e.title.$t,s=e.link.find(e=>"alternate"===e.rel).href,i=e.media$thumbnail?e.media$thumbnail.url.replace(/\/s72-c\//,"/s200-c/"):"";t+=`<a class="related-post-card" href="${s}">${i?`<img class="post-thumbnail" src="${i}" alt="${n}" loading="lazy"/>`:`<div class="post-thumbnail">📄</div>`}<div class="post-content"><h4>${n}</h4></div></a>`});e.innerHTML=t}}).catch(e=>{console.error("Error fetching related posts:",e)})}function generateTOC(){const e=document.getElementById("auto-toc"),t=document.querySelector(".post-body");if(e&&t){const n=t.querySelectorAll("h2, h3");if(n.length>2){let s='<h3 class="toc-title">Table of Contents</h3><ul class="toc-list">';n.forEach((e,t)=>{const n="toc-"+t;e.id=n;s+=`<li><a href="#${n}">${e.textContent}</a></li>`});s+="</ul>";e.innerHTML=s;e.style.display="block"}}}document.addEventListener("DOMContentLoaded",()=>{initMobileNav();initBreakingNews();initThemeToggle();initBackToTop();if(document.body.classList.contains("item")){generateTOC();fetchRelatedPosts()}});window.copyPostLink=copyPostLink;
